---
title: "playground"
author: "Tiffany Hsu"
date: "2/17/2022"
output: html_document
---

```{r setup, include=FALSE, warnings = FALSE, message=FALSE}
library(tidyverse)
library(here)
library(janitor)
```

```{r}
covid_food <- read_csv(here("data/Final_Pulse_data.csv")) %>%
  clean_names()

```


# widget 1

- Widget 1: Radio buttons to select the age range (18-24, 25-39, 40-54, 55-64, 65 and above)
- Output 1: Bar graph to visualize the change in survey responses based in the US. (ie. Enough of the kinds of food wanted, Enough Food, but not always the kinds wanted, Sometimes not enough to eat, Often not enough to eat, Did not report)

View for a certain age range (US) - bar graph
18-24, 25-39, 40-54, 55-64, 65 and above

```{r}
# step 1: only filter for only age ranges
age_range <- covid_food %>% 
  filter(
    age == "18 - 24")

for (i in 1:length(age_range$week)) {
age_range$week[[i]] <- str_replace(age_range$week[[i]], "week", "")
}

age_range$week <- sapply(age_range$week, as.numeric) 


age_range_by_week <- age_range %>% 
  group_by(week) %>% 
  summarize((sum(enough_of_the_kinds_of_food_wanted) + sum(enough_food_but_not_always_the_kinds_wanted))/ (sum(enough_of_the_kinds_of_food_wanted) + sum(enough_food_but_not_always_the_kinds_wanted) + sum(sometimes_not_enough_to_eat) + sum(often_not_enough_to_eat) + sum(did_not_report) )) %>% 
  rename(enough_of_the_kinds_of_food_wanted_ratio = '`/`(...)')

ggplot(data = age_range_by_week, aes(x = week, y = enough_of_the_kinds_of_food_wanted_ratio)) +
  geom_line(color = "darkgreen") +
  theme_minimal() +
  labs(y = "Number of People Indicating Enough Food", #label y,
       x = "Week Number") #+#and x axis
  #scale_y_continuous(labels = scales::comma)

   #   age == "25 - 39",
  #   age == "40 - 54",
  #   age == "55 - 64",
  #   age == "65 and above"
  # )
```

```{r}
# INCOME LEVELS

income_range <- covid_food %>% 
  filter(
    income == "Less than $25,000")

for (i in 1:length(income_range$week)) {
income_range$week[[i]] <- str_replace(income_range$week[[i]], "week", "")
}

income_range$week <- sapply(income_range$week, as.numeric) 


income_range_by_week <- income_range %>% 
  group_by(week) %>% 
  summarize((sum(enough_of_the_kinds_of_food_wanted) + sum(enough_food_but_not_always_the_kinds_wanted)) / (sum(enough_of_the_kinds_of_food_wanted) + sum(enough_food_but_not_always_the_kinds_wanted) + sum(sometimes_not_enough_to_eat) + sum(often_not_enough_to_eat) + sum(did_not_report) )) %>% 
  rename(enough_of_the_kinds_of_food_wanted_ratio = '`/`(...)')

ggplot(data = income_range_by_week, aes(x = week, y = enough_of_the_kinds_of_food_wanted_ratio)) +
  geom_line(color = "darkgreen") +
  theme_minimal() +
  labs(y = "Number of People Indicating Enough Food", #label y,
       x = "Week Number") 
```

```{r}

```

